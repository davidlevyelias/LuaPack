{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "LuaPack Configuration",
	"type": "object",
	"additionalProperties": false,
	"required": ["entry"],
	"properties": {
		"entry": {
			"type": "string",
			"description": "Path to the entry Lua file that kicks off dependency analysis."
		},
		"output": {
			"type": "string",
			"description": "Optional destination path for the generated bundle. When omitted, LuaPack will emit '<entry-name>_packed.lua' alongside the entry file."
		},
		"sourceRoot": {
			"type": "string",
			"description": "Root directory for resolving project-local modules.",
			"default": "."
		},
		"modules": {
			"type": "object",
			"description": "Controls module resolution, inclusion, and overrides.",
			"additionalProperties": false,
			"properties": {
				"ignoreMissing": {
					"type": "boolean",
					"description": "When true, unresolved modules are reported but do not stop bundling.",
					"default": false
				},
				"ignore": {
					"type": "array",
					"description": "Module identifiers to skip entirely with highest priority.",
					"items": { "type": "string" },
					"default": []
				},
				"external": {
					"type": "object",
					"description": "Configuration for modules found outside the sourceRoot.",
					"additionalProperties": false,
					"properties": {
						"enabled": {
							"type": "boolean",
							"description": "Allow bundling of external modules.",
							"default": false
						},
						"recursive": {
							"type": "boolean",
							"description": "Resolve dependencies of external modules when enabled.",
							"default": true
						},
						"paths": {
							"type": "array",
							"description": "Additional search locations for external modules.",
							"items": { "type": "string" },
							"default": []
						},
						"env": {
							"type": "array",
							"description": "Environment variables to inspect for external search paths (defaults to LUA_PATH when omitted).",
							"items": { "type": "string" }
						}
					}
				},
				"overrides": {
					"type": "object",
					"description": "Per-module configuration overrides.",
					"propertyNames": {
						"type": "string",
						"pattern": "^[\\w\\.\\-/]+$"
					},
					"additionalProperties": {
						"$ref": "#/definitions/moduleOverride"
					},
					"default": {}
				}
			},
			"default": {}
		},
		"obfuscation": {
			"type": "object",
			"description": "Integrated obfuscation settings.",
			"additionalProperties": false,
			"properties": {
				"tool": {
					"type": "string",
					"description": "Select the built-in obfuscation pipeline.",
					"enum": ["internal", "none"],
					"default": "none"
				},
				"config": {
					"type": "object",
					"description": "Configuration for the selected tool.",
					"additionalProperties": false,
					"properties": {
						"minify": {
							"type": "boolean",
							"description": "Minify Lua source using lua-format.",
							"default": false
						},
						"renameVariables": {
							"description": "Controls local variable renaming.",
							"oneOf": [
								{ "type": "boolean" },
								{
									"type": "object",
									"additionalProperties": false,
									"properties": {
										"enabled": {
											"type": "boolean",
											"description": "Enable variable renaming.",
											"default": true
										},
										"min": {
											"type": "integer",
											"minimum": 1,
											"description": "Minimum generated identifier length.",
											"default": 5
										},
										"max": {
											"type": "integer",
											"minimum": 1,
											"description": "Maximum generated identifier length.",
											"default": 5
										}
									},
									"required": ["enabled"]
								}
							],
							"default": false
						},
						"ascii": {
							"type": "boolean",
							"description": "Apply ASCII obfuscation pass.",
							"default": false
						}
					},
					"default": {}
				}
			},
			"default": {
				"tool": "none",
				"config": {
					"minify": false,
					"renameVariables": false,
					"ascii": false
				}
			}
		}
	},
	"definitions": {
		"moduleOverride": {
			"type": "object",
			"additionalProperties": false,
			"properties": {
				"path": {
					"type": "string",
					"description": "Optional explicit path to use instead of resolver result."
				},
				"recursive": {
					"type": "boolean",
					"description": "When false, skip dependency analysis for this override.",
					"default": true
				}
			},
			"default": {}
		}
	}
}
